{% extends "users/basic.html" %}
{% load crispy_forms_tags %}

{% block title %}Change Password{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-3 text-center">Change Password</h2>

    <form method="POST" class="p-4 shadow-sm rounded bg-light">
        {% csrf_token %}

        <div class="mb-3">
            <label for="id_old_password" class="form-label">Old Password</label>
            <div class="input-group">
                {{ form.old_password }}
                <button type="button" class="btn btn-outline-secondary toggle-password" data-target="id_old_password">
                    <img src="https://img.icons8.com/ios-filled/24/invisible.png" alt="Toggle visibility">
                </button>
            </div>
        </div>

        <div class="mb-3">
            <label for="id_new_password1" class="form-label">New Password</label>
            <div class="input-group">
                {{ form.new_password1 }}
                <button type="button" class="btn btn-outline-secondary toggle-password" data-target="id_new_password1">
                    <img src="https://img.icons8.com/ios-filled/24/invisible.png" alt="Toggle visibility">
                </button>
            </div>
        </div>

        <div class="mb-3">
            <label for="id_new_password2" class="form-label">Confirm New Password</label>
            <div class="input-group">
                {{ form.new_password2 }}
                <button type="button" class="btn btn-outline-secondary toggle-password" data-target="id_new_password2">
                    <img src="https://img.icons8.com/ios-filled/24/invisible.png" alt="Toggle visibility">
                </button>
            </div>
        </div>

        <button type="submit" class="btn btn-primary w-100">Change Password</button>

        <div class="text-center mt-3">
            <a href="{% url 'login' %}" class="text-decoration-none">‚Üê Back to Login</a>
        </div>
    </form>
</div>

<script>
    document.querySelectorAll('.toggle-password').forEach(button => {
        button.addEventListener('click', function() {
            let targetId = this.getAttribute('data-target');
            let passwordField = document.getElementById(targetId);
            let icon = this.querySelector('img');
            
            if (passwordField.type === "password") {
                passwordField.type = "text";
                icon.src = "https://img.icons8.com/ios-filled/24/visible.png";
            } else {
                passwordField.type = "password";
                icon.src = "https://img.icons8.com/ios-filled/24/invisible.png";
            }
        });
    });
</script>
{% endblock %}
